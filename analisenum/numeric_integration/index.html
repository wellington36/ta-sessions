<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../img/favicon.ico">

    
    <title>Integração Numérica - Teaching Assistant</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/base.min.css" rel="stylesheet">
    <link href="../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="../..">Teaching Assistant</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../info/">Análise Numérica</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../edp/info/">EDP</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../curvas/info/">Curvas</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../infestatistica/info/">Estatística</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../edo/info/">EDO</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../alglin/info/">Álgebra Linear</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li>
                        <a href="https://lucasmoschen.github.io">Página Inicial</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#integracao-numerica">Integração Numérica</a></li>
            <li class="second-level"><a href="#formula-de-newton-cotes">Fórmula de Newton-Cotes</a></li>
                
                <li class="third-level"><a href="#trapezio-simples">Trapézio Simples</a></li>
                <li class="third-level"><a href="#formula-de-simpson-simples">Fórmula de Simpson Simples</a></li>
                <li class="third-level"><a href="#precisao">Precisão</a></li>
                <li class="third-level"><a href="#formulas-compostas">Fórmulas compostas</a></li>
            <li class="second-level"><a href="#quadratura-de-gauss-legendre">Quadratura de Gauss-Legendre</a></li>
                
                <li class="third-level"><a href="#polinomios-ortogonais">Polinômios Ortogonais</a></li>
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="integracao-numerica">Integração Numérica</h1>
<p>O objetivo da integração numérica é estimar 
<script type="math/tex; mode=display">I = \int_a^b f(x) \, dx,</script>
principalmente quando não sabemos a antiderivada de <script type="math/tex">f</script>. Podemos extender para
problemas de dimensão maior, isto é, integrar 
<script type="math/tex; mode=display">I = \int_R f(x) \, dx,</script>
em algum retângulo <script type="math/tex">R</script> em dimensão <script type="math/tex">\mathbb{R}^n</script>. </p>
<p>Chamamos de <strong>quadratura numérica</strong> o método básico de aproximação de <script type="math/tex">I</script>
através da soma <script type="math/tex">\sum_{i=0}^n a_i f(x_i)</script>. </p>
<h2 id="formula-de-newton-cotes">Fórmula de Newton-Cotes</h2>
<p>De forma geral, podemos
integrar o polinômio interpolador de Lagrange que aproxima para aproximar 
a integração da função aproximada pela função, isto é, </p>
<p>
<script type="math/tex; mode=display">\int_a^b f(x) \, dx = \int_a^b \sum_{i=0}^n f(x_i) L_i(x) + \int_a^b
\prod_{i=0}^n (x - x_i)\frac{f^{(n+1)}(\xi(x))}{(n+1)!} \, dx</script>
em que <script type="math/tex">\{L_i(x)\}_{i=0}^n</script> forma a base dos <a href="https://lucasmoschen.github.io/ta-sessions/analisenum/polynomial_interpolation/#polinomios-de-lagrange">polinômios de Lagrange</a>.</p>
<p>Nesse caso, uma possível aproximação para essa integral é 
<script type="math/tex; mode=display"> \int_a^b \sum_{i=0}^n f(x_i) L_i(x) \, dx = \sum_{i=0}^n a_if(x_i),</script>
em que <script type="math/tex">a_i = \int_a^b L_i(x) \, dx</script>. O erro dessa estimação é dado por 
<script type="math/tex; mode=display">E(f) = \int_a^b
\prod_{i=0}^n (x - x_i)\frac{f^{(n+1)}(\xi(x))}{(n+1)!} \, dx.</script>
</p>
<p>A <strong>fórmula de Newton-Cotes <script type="math/tex">(n+1)</script>-pontos fechada</strong> usa os 
pontos interpoladores <script type="math/tex">x_i = x_0 + ih</script> em que <script type="math/tex">h = (b-a)/n, x_0 = a</script> e 
<script type="math/tex">x_n = b</script>. Ela é dita fechada por incluir os endpoints do intervalo. 
Apresentamos dois métodos com esse tipo de fórmula. Além do fechado, podemos tomar os pontos igualmente espaçados no interior 
do intervalo, isto é, <script type="math/tex">h = (b-a)/(n+2)</script> e <script type="math/tex">x_i = x_0 + (i+1)h</script> para <script type="math/tex">i = 0,
\dots, n</script>. Essas são ditas <strong>fórmula de Newton-Cotes <script type="math/tex">(n+1)</script>-pontos aberta</strong>.
Um exemplo conhecida é a regra do ponto médio que toma apenas um ponto 
<script type="math/tex">x_0 = (a + b)/2</script>. </p>
<h3 id="trapezio-simples">Trapézio Simples</h3>
<p>Nesse caso, definimos <script type="math/tex">x_0 = a, x_1 = b</script> e <script type="math/tex">h=b-a</script>. Assim 
<script type="math/tex; mode=display">a_0 = \int_{x_0}^{x_1} \frac{(x - x_1)}{(x_0-x_1)} \quad \text{ e } a_1 =
\int_{x_0}^{x_1} \frac{(x - x_0)}{(x_1-x_0)}.</script>
</p>
<p>Vamos utilizar o <a href="https://www.math.usm.edu/lambers/mat460/fall09/lecture3.pdf">Teorema do Valor Médio Ponderado para Integrais</a> 
(página 5) para estimar o erro. Nesse caso, ele é da seguinte forma: 
<script type="math/tex; mode=display">\begin{split}
  E(f) &= \int_{x_0}^{x_1} (x - x_0)(x - x_1)\frac{f^{(2)}(\xi(x))}{2!} \, dx
\\
&= \frac{f^{(2)}(\xi)}{2}\left[\frac{x^3}{3} - 
\frac{(x_0 + x_1)}{2}x^2 + x_0x_1x\right]_{x_0}^{x_1} \\
&= -\frac{h^3}{6}f^{(2)}(\xi),  
\end{split}</script>
para algum <script type="math/tex">\xi \in (a,b)</script>.</p>
<p>A regra do trapézio se resume, então, a 
<script type="math/tex; mode=display">\int_a^b f(x) \, dx = \frac{h}{2}[f(a) + f(b)] - \frac{h^3}{12}f''(\xi).</script>
</p>
<h3 id="formula-de-simpson-simples">Fórmula de Simpson Simples</h3>
<p>Para a fórmula de Simpson, fazemos <script type="math/tex">x_0 = a, x_2 = b</script> e <script type="math/tex">x_1 = a + h</script>, 
para <script type="math/tex">h = (b-a)/2</script>, isto é, adicionamos mais um ponto para a aproximação 
polinomial. Nesse caso, </p>
<p>
<script type="math/tex; mode=display">a_0 = \int_{x_0}^{x_2} \frac{(x - x_1)(x - x_2)}{(x_0-x_1)(x_0 - x_2)}, a_1 =
 \int_{x_0}^{x_2} \frac{(x - x_0)(x - x_2)}{(x_1-x_0)(x_1 - x_2)} \text{ e }a_2 =
 \int_{x_0}^{x_2} \frac{(x - x_0)(x - x_1)}{(x_2-x_0)(x_2 - x_1)}.</script>
</p>
<p>Com essa derivação, vamos obter um erro <script type="math/tex">O(h^4)</script> com um 
termo relacionado a <script type="math/tex">f^{(3)}</script>. Podemos reduzir esse erro com 
esses mesmos pontos usando uma abordagem levemente diferente.
É usada a expansão de Taylor em <script type="math/tex">x_1</script> até ordem e um pouco de
simetria <script type="math/tex">x_2 - x_1 = x_1 - x_0</script> para verificar que 
<script type="math/tex; mode=display">\int_{x_0}^{x_2} f(x) \, dx = 2hf(x_1) + \frac{h^3}{3}f''(x_1) + \frac{f^{(4)}(\xi')}{60}h^5.</script>
</p>
<p>Além disso, é usada a seguinte aproximação para <script type="math/tex">f''(x_1)</script>: </p>
<p>
<script type="math/tex; mode=display">f''(x_1) = \frac{1}{h^2}[f(x_0) - 2f(x_1) + f(x_2)] -
\frac{h^2}{12}f^{(4)}(\xi'')</script>
</p>
<p>a fim de obter a fórmula de Simpson </p>
<p>
<script type="math/tex; mode=display">\int_{a}^{b} f(x) \, dx = \frac{h}{3}[f(a) + 4f(a/2+b/2) + f(b)] -
\frac{h^5}{90}f^{(4)}(\xi).</script>
</p>
<h3 id="precisao">Precisão</h3>
<p>O <strong>grau de precisão</strong> da fórmula de quadratura é o maior inteiro 
positivo <script type="math/tex">n</script> tal que a fórmula seja exata para <script type="math/tex">x^k</script> para cada
<script type="math/tex">k = 0,\dots,n</script>. Para os exemplos desenvolvidos acima, basta olhar 
qual o maior inteiro <script type="math/tex">n</script> tal que <script type="math/tex">f^{(2)} \equiv 0</script> no caso 
do trapézio e <script type="math/tex">f^{(4)} = 0</script> no caso de Simpson. </p>
<h3 id="formulas-compostas">Fórmulas compostas</h3>
<p>É claro que as fórmulas deduzidas acima ficam bem ruins quando <script type="math/tex">b - a</script> é
grande. Para isso, a ideia é subdividir o intervalo <script type="math/tex">[a,b]</script> em <script type="math/tex">a = x_0 <
\dots < x_n = b</script> (de forma igualmente espaçada, em geral) e aplicar a
quadratura numérica a cada um deles. Essa abordagem tira proveito da seguinte
propriedade: 
<script type="math/tex; mode=display">\int_a^b f(x) \, dx = \int_a^c f(x) \, dx + \int_c^b f(x) \, dx.</script>
</p>
<p>Para a regra de Simpson composta teremos que 
<script type="math/tex; mode=display">\int_a^b f(x) \, dx = \frac{h}{3}\left[f(a) + 2\sum_{j=1}^{n/2 - 1}
f(x_{2j}) + 4\sum_{j=1}^{n/2} f(x_{2j-1}) + f(b)\right] -
\frac{b-a}{180}h^4f^{(4)}(\xi),</script>
para <script type="math/tex">\xi \in (a,b)</script> e <script type="math/tex">h = (b-a)/n</script>. O erro, portanto, é <script type="math/tex">O(h^4)</script>.</p>
<p>A fórmula do trapézio é similar: 
<script type="math/tex; mode=display">\int_a^b f(x) \, dx = \frac{h}{2}\left[f(a) + 2\sum_{j=1}^{n - 1}
f(x_{j}) + f(b)\right] -
\frac{b-a}{12}h^2f^{(2)}(\xi).</script>
</p>
<h2 id="quadratura-de-gauss-legendre">Quadratura de Gauss-Legendre</h2>
<p>Este método escolhe os pontos para a interpolação de forma ótima 
ao invés de igualmente espaçada. Assim, os pontos <script type="math/tex">x_i</script> e os 
coeficiente <script type="math/tex">c_i</script> são escolhidos a minimizar 
<script type="math/tex; mode=display">\left|\int_a^b f(x) \, dx - \sum_{i=1}^n c_i f(x_i)\right|.</script>
Para medir essa acurácia, assumimos que a escolha ótima desses 
valores produzo maior grau de precisão, definido acima. </p>
<h3 id="polinomios-ortogonais">Polinômios Ortogonais</h3>
<p>Considere o espaço das funções contínuas definidas em <script type="math/tex">[a,b]</script> (isso significa que um 
elemento desse conjunto é uma função contínua definida em <script type="math/tex">[a,b]</script>) com 
o seguinte produto interno: 
<script type="math/tex; mode=display">\langle f, g \rangle = \int_a^b f(x)g(x) \, dx.</script>
Observe como esse produto interno é uma extensão do somatório dos 
produtos dos componentes de dois vetores. Dizemos que duas funções
são ortogonais quando <script type="math/tex">\langle f,g \rangle = 0</script>. </p>
<p>Considere o espaço dos polinômios de grau até <script type="math/tex">n</script> com o produto interno
apresentado acima no intervalo <script type="math/tex">[-1,1]</script>. Os <strong>polinômios de Legendre</strong>
são polinômios ortogonais e são obtidos fazendo o <a href="https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process">processo de
Gram-Schmidt</a>
sobre a base <script type="math/tex">\{1, x, x^2, x^3, \dots, x^n\}</script>. </p>
<p>Abaixo estão alguns dos polinômios de Legendre: </p>
<p>
<script type="math/tex; mode=display">P_0(x) = 1, P_1(x) = x, P_2(x) = x^2 - \frac{1}{3}, P_3(x) = x^3 -
\frac{3}{5}x, P_4(x) = x^4 - \frac{6}{7}x^2 + \frac{3}{35}.</script>
</p>
<blockquote>
<p>Suponha que <script type="math/tex">x_1, \dots, x_n</script> são as raízes do polinômio de Legendre 
<script type="math/tex">P_n(x)</script> e que 
<script type="math/tex; mode=display"> c_i = \int_{-1}^1 \prod_{j \neq i} \frac{x-x_j}{x_i-x_j} \, dx. </script>
Se <script type="math/tex">P(x)</script> é qualquer polinômio de grau menor do que <script type="math/tex">2n</script>, então, 
<script type="math/tex; mode=display">\int_{-1}^1 P(x) \, dx = \sum_{i=1}^n c_iP(x_i).</script>
</p>
</blockquote>
<h4 id="formula-de-gauss-legendre-para-intervalo-qualquer">Fórmula de Gauss-Legendre para intervalo qualquer</h4>
<p>Basta observar que 
<script type="math/tex; mode=display">\int_a^b f(x) \, dx = \frac{b-a}{2}\int_{-1}^1 f\left(\frac{(b-a)t +
(b+a)}{2}\right) \, dt</script>
e aplicar Gauss-Legendre para a integral à direita. </p></div>
        
        
    </div>

    
      <footer class="col-md-12 text-center">
          
          
            <hr>
            <p>
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
            </p>
          

          
          
      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = "../.."</script>
    
    <script src="../../js/base.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
